<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ROS(kinetic)有用指令集 | Cola In Library</title><meta name="keywords" content="Library,机器人,ROS"><meta name="author" content="Cola &amp; Library"><meta name="copyright" content="Cola &amp; Library"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="介绍ROS的kinetic版本有用的一些指令集">
<meta property="og:type" content="article">
<meta property="og:title" content="ROS(kinetic)有用指令集">
<meta property="og:url" content="https://colainlibrary.com/archives/25595.html">
<meta property="og:site_name" content="Cola In Library">
<meta property="og:description" content="介绍ROS的kinetic版本有用的一些指令集">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://colainlibrary.com/images/post-9.jpg">
<meta property="article:published_time" content="2019-08-03T16:30:00.000Z">
<meta property="article:modified_time" content="2022-08-18T05:23:16.076Z">
<meta property="article:author" content="Cola &amp; Library">
<meta property="article:tag" content="Library">
<meta property="article:tag" content="机器人">
<meta property="article:tag" content="ROS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://colainlibrary.com/images/post-9.jpg"><link rel="shortcut icon" href="/images/favicon-28x32.png"><link rel="canonical" href="https://colainlibrary.com/archives/25595"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?42fb0ad9fb188b1965ef3ab7b4344df5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="/css/logofont.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ROS(kinetic)有用指令集',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-18 05:23:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/userfont.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Cola In Library" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.jpg" onerror="onerror=null;src='/images/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/post-9.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Cola In Library</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ROS(kinetic)有用指令集</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-08-03T16:30:00.000Z" title="发表于 2019-08-03 16:30:00">2019-08-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-18T05:23:16.076Z" title="更新于 2022-08-18 05:23:16">2022-08-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8E%A7%E5%88%B6/">机器人控制</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/archives/25595.html" data-flag-title="ROS(kinetic)有用指令集"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/archives/25595.html#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/archives/25595.html" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>本文中的环境为Ubuntu16.04LTS + ROS(kinetic).</p>
</blockquote>
<span id="more"></span>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>由于从ROS的官网上的教程并没有实时更新，上面混杂了一些旧版本的东西，看起来有些麻烦，而且有的介绍过于繁琐，因此本篇博客旨在介绍笔者使用版本的精简指令集。关于指令的详细介绍，还需从官网上查看相关内容。</p>
<h1 id="指令介绍"><a href="#指令介绍" class="headerlink" title="指令介绍"></a>指令介绍</h1><h2 id="ROS安装指令"><a href="#ROS安装指令" class="headerlink" title="ROS安装指令"></a>ROS安装指令</h2><p>在执行下面的指令前，请注意先将源换位内地源，推荐清华源。</p>
<blockquote>
<p>2021.08.09由于一些原因，官方的安装教程有所改变：<br>ROS 官方教程：<a target="_blank" rel="noopener" href="http://wiki.ros.org/ROS/Tutorials">http://wiki.ros.org/ROS/Tutorials</a><br>ROS kinetic 版本安装：<a target="_blank" rel="noopener" href="http://wiki.ros.org/kinetic/Installation/Ubuntu">http://wiki.ros.org/kinetic/Installation/Ubuntu</a><br>ROS rosdep 的问题<br>执行<code>sudo rosdep init</code> 出错，参考 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/77483614">解决方案1</a> <a target="_blank" rel="noopener" href="https://blog.csdn.net/haoruilin/article/details/104360432?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase">解决方案2</a><br>上一步正确后，执行 <code>rosdep update</code>的问题，这个一般是由于Python版本不兼容造成的。注意，这时候系统不应存在已经加载的Python3环境（实际环境中有多个Python版本注意切换，双系统的虚拟环境，则应该关闭虚拟环境，还不行就要重启系统再尝试）<br>上述操作建议科学上网后再进行。</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo sh -c <span class="string">&#x27;echo &quot;deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/ros-latest.list&#x27;</span></span><br><span class="line">sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:<span class="number">80</span> --recv-key <span class="number">0xB01FA116</span></span><br><span class="line">sudo apt-get update	<span class="comment">#如果更新失败提示GPT error，输入sudo apt-key adv --recv-keys --keyserver keyserver.ubuntu.com F42ED6FBAB17C654</span></span><br><span class="line">sudo apt-get install ros-kinetic-desktop-full</span><br><span class="line">sudo rosdep init</span><br><span class="line">rosdep update</span><br><span class="line">echo <span class="string">&quot;source /opt/ros/kinetic/setup.bash&quot;</span> &gt;&gt; ~/.bashrc</span><br><span class="line">source ~/.bashrc</span><br><span class="line">sudo apt install python-rosinstall python-rosinstall-generator python-wstool build-essential</span><br></pre></td></tr></table></figure>
<h2 id="UR5的仿真环境安装与使用"><a href="#UR5的仿真环境安装与使用" class="headerlink" title="UR5的仿真环境安装与使用"></a>UR5的仿真环境安装与使用</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-kinetic-universal-robot</span><br><span class="line">roslaunch ur_gazebo ur5.launch	</span><br><span class="line">roslaunch ur5_moveit_config ur5_moveit_planning_execution.launch sim:=<span class="literal">true</span></span><br><span class="line">roslaunch ur5_moveit_config moveit_rviz.launch config:=<span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="ROS文件系统介绍"><a href="#ROS文件系统介绍" class="headerlink" title="ROS文件系统介绍"></a>ROS文件系统介绍</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-kinetic-ros-tutorials		<span class="comment">//安装ros-tutorials程序包</span></span><br><span class="line">rospack find roscpp									<span class="comment">//rospack find [包名称]  rospack (/rospack)允许你获取软件包的有关信息。在本教程中，我们只涉及到rospack中find参数选项，该选项可以返回软件包的路径信息。</span></span><br><span class="line">roscd roscpp										<span class="comment">//roscd [本地包名称[/子目录]]   直接切换工作目录到某个软件包或者软件包集当中</span></span><br><span class="line">pwd													<span class="comment">//输出当前工作目录</span></span><br><span class="line">echo $ROS_PACKAGE_PATH								<span class="comment">//查看ROS_PACKAGE_PATH</span></span><br><span class="line">roscd log											<span class="comment">//切换到ROS保存日记文件的目录下。如果你没有执行过任何ROS程序，系统会报错说该目录不存在。</span></span><br><span class="line">rosls roscpp_tutorials								<span class="comment">//rosls [本地包名称[/子目录]] 直接按软件包的名称而不是绝对路径来罗列目录</span></span><br></pre></td></tr></table></figure>
<h2 id="使用catkin创建工作空间"><a href="#使用catkin创建工作空间" class="headerlink" title="使用catkin创建工作空间"></a>使用catkin创建工作空间</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">source /opt/ros/kinetic/setup.bash					<span class="comment">//sourced your environment</span></span><br><span class="line">mkdir -p ~/catkin_ws/src</span><br><span class="line">cd ~/catkin_ws/</span><br><span class="line">catkin_make</span><br><span class="line">source devel/setup.bash</span><br><span class="line">echo $ROS_PACKAGE_PATH 								<span class="comment">//确认环境变量包含了目录</span></span><br></pre></td></tr></table></figure>
<h2 id="创建ROS程序包"><a href="#创建ROS程序包" class="headerlink" title="创建ROS程序包"></a>创建ROS程序包</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/catkin_ws/src</span><br><span class="line">catkin_create_pkg beginner_tutorials std_msgs rospy roscpp 		<span class="comment">//使用catkin_create_pkg命令来创建一个名为&#x27;beginner_tutorials&#x27;的新程序包，这个程序包依赖于std_msgs、roscpp和rospy</span></span><br><span class="line">rospack depends1 beginner_tutorials 							<span class="comment">//使用rospack命令来查看一级依赖包</span></span><br><span class="line">rospack depends beginner_tutorials								<span class="comment">//使用rospack可以递归检测出所有的依赖包</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>本节还介绍了.xml文件的书写方法</p>
</blockquote>
<h2 id="编译ROS程序包"><a href="#编译ROS程序包" class="headerlink" title="编译ROS程序包"></a>编译ROS程序包</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source /opt/ros/kinetic/setup.bash					<span class="comment">//先source你的环境配置(setup)文件</span></span><br><span class="line">cd catkin工作空间</span><br><span class="line">catkin_make											<span class="comment">//编译</span></span><br><span class="line">catkin_make --source my_src							<span class="comment">//编译存放在了my_src中，而非在默认工作空间中（~/catkin_ws/src)的源代码</span></span><br></pre></td></tr></table></figure>
<h2 id="理解ROS节点"><a href="#理解ROS节点" class="headerlink" title="理解ROS节点"></a>理解ROS节点</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-kinetic-ros-tutorials		<span class="comment">//安装龟龟模拟器</span></span><br><span class="line">roscore												<span class="comment">//运行所有ROS程序前首先要运行的命令</span></span><br><span class="line">rosnode list										<span class="comment">//列出活跃的节点，本例为/rosout</span></span><br><span class="line">rosnode info /rosout 								<span class="comment">//返回特定节点的信息</span></span><br><span class="line">rosrun turtlesim turtlesim_node						<span class="comment">//打开新终端，运行turtlesim。    rosrun [package_name] [node_name]</span></span><br><span class="line">rosnode list										<span class="comment">//打开新终端，查看节点：/rosout  /turtlesim</span></span><br><span class="line">rosrun turtlesim turtlesim_node __name:=my_turtle   <span class="comment">//关闭原来的turtlesim，打开新终端运行。改变节点名称</span></span><br><span class="line">rosnode list 										<span class="comment">//查看新的节点名称：/rosout /my_turtle</span></span><br><span class="line">rosnode ping my_turtle								<span class="comment">//使用另一个节点来ping该节点</span></span><br></pre></td></tr></table></figure>
<h2 id="理解ROS话题"><a href="#理解ROS话题" class="headerlink" title="理解ROS话题"></a>理解ROS话题</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">roscore 							<span class="comment">//新开一个终端，打开ros</span></span><br><span class="line">rosrun turtlesim turtlesim_node		<span class="comment">//新开一个终端。这是接受消息的节点</span></span><br><span class="line">rosrun turtlesim turtle_teleop_key	<span class="comment">//新开一个终端，通过键盘来控制龟龟运动。这也是发布消息的节点</span></span><br><span class="line">rosrun rqt_graph rqt_graph			<span class="comment">//新开一个终端，创建一个显示当前系统运行情况的动态图形</span></span><br><span class="line">rostopic -h							<span class="comment">//新开一个终端，查看rostopic的子命令</span></span><br><span class="line">rostopic echo /turtle1/cmd_vel		<span class="comment">//你可能看不到任何东西因为现在还没有数据发布到该话题上。接下来我们通过按下方向键使turtle_teleop_key节点发布数据。可以返回rqt_graph中刷新查看</span></span><br><span class="line">rostopic list -v 					<span class="comment">//查看有关所发布和订阅的话题及其类型的详细信息</span></span><br><span class="line">rostopic type /turtle1/cmd_vel		<span class="comment">//查看发布在某个话题上的消息类型，会看到：geometry_msgs/Twist</span></span><br><span class="line">rosmsg show geometry_msgs/Twist		<span class="comment">//查看消息的详细情况。根据该结果可以知道turtlesim节点所期望的消息类型(可看到包含linear和angular两个值)，接下来我们就可以给turtle发布命令了</span></span><br><span class="line">rostopic pub <span class="number">-1</span> /turtle1/cmd_vel geometry_msgs/Twist -- <span class="string">&#x27;[2.0, 0.0, 0.0]&#x27;</span> <span class="string">&#x27;[0.0, 0.0, 1.8]&#x27;</span></span><br><span class="line">									<span class="comment">//rostopic pub可以把数据发布到当前某个正在广播的话题上。用法:rostopic pub [topic] [msg_type] [args]</span></span><br><span class="line">									<span class="comment">//以上命令会发送一条消息给turtlesim，告诉它以2.0大小的线速度和1.8大小的角速度开始移动。</span></span><br><span class="line">									<span class="comment">//-1: （单个破折号）这个参数选项使rostopic发布一条消息后马上退出。</span></span><br><span class="line">									<span class="comment">///turtle1/cmd_vel: 消息所发布到的话题名称</span></span><br><span class="line">									<span class="comment">//geometry_msgs/Twist: 所发布消息类型</span></span><br><span class="line">									<span class="comment">//--: 双破折号）这会告诉命令选项解析器接下来的参数部分都不是命令选项。这在参数里面包含有破折号-（比如负号）时是必须要添加的</span></span><br><span class="line">									<span class="comment">//&#x27;[2.0, 0.0, 0.0]&#x27; &#x27;[0.0, 0.0, 1.8]&#x27;: 正如之前提到的，在一个geometry_msgs/Twist消息里面包含有两个浮点型元素：linear和angular。</span></span><br><span class="line">									<span class="comment">//在本例中，&#x27;[2.0, 0.0, 0.0]&#x27;是linear的值，&#x27;[0.0, 0.0, 1.8]&#x27;是angular的值。这些参数其实是按照YAML语法格式编写的，这在YAML文档 (/ROS/YAMLCommandLine)中有更多的描述。</span></span><br><span class="line">rostopic pub /turtle1/cmd_vel geometry_msgs/Twist -r <span class="number">1</span> -- <span class="string">&#x27;[2.0, 0.0, 0.0]&#x27;</span> <span class="string">&#x27;[0.0, 0.0, 1.8]&#x27;</span></span><br><span class="line">									<span class="comment">//这条命令以1Hz的频率发布速度命令到速度话题上。使用rostopic pub -r命令来发布一个稳定的命令流</span></span><br><span class="line">rostopic hz /turtle1/pose			<span class="comment">//rostopic hz命令可以用来查看数据发布的频率。	rostopic hz [topic]	</span></span><br><span class="line">rostopic type /turtle1/pose | rosmsg show</span><br><span class="line">									<span class="comment">//结合rostopic type和rosmsg show命令来获取关于某个话题的更深层次的信息	</span></span><br><span class="line">									<span class="comment">//可以看到pose下有五个信息: x y theta linear_velocity angular_velocity</span></span><br><span class="line">rosrun rqt_plot rqt_plot			<span class="comment">//使用rqt_plot命令来绘制正在发布到/turtle1/pose话题上的数据变化图形	</span></span><br><span class="line">									<span class="comment">//这会弹出一个新窗口，在窗口左上角的一个文本框里面你可以添加需要绘制的话题。在里面输入/turtle1/pose/x后之前处于禁用状态的加号按钮将会被使能变亮。按一下该按钮，并</span></span><br><span class="line">									<span class="comment">//对/turtle1/pose/y重复相同的过程。现在你会在图形中看到turtle的x-y位置坐标图。</span></span><br><span class="line">									<span class="comment">//按下减号按钮会显示一组菜单让你隐藏图形中指定的话题。现在隐藏掉你刚才添加的话题并添加/turtle1/pose/theta											</span></span><br></pre></td></tr></table></figure>
<h2 id="理解ROS服务和参数"><a href="#理解ROS服务和参数" class="headerlink" title="理解ROS服务和参数"></a>理解ROS服务和参数</h2><p>在小乌龟仍然启动的基础上：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rosservice list						<span class="comment">//输出可用服务的信息</span></span><br><span class="line">rosservice call						<span class="comment">//调用带参数的服务</span></span><br><span class="line">rosservice type 					<span class="comment">//输出服务类型</span></span><br><span class="line">rosservice find 					<span class="comment">//依据类型寻找服务find services by service type </span></span><br><span class="line">rosservice uri 						<span class="comment">//输出服务的ROSRPC uri		</span></span><br><span class="line">rosservice type clear				<span class="comment">//查看clear服务类型，clear是rosservice list中的一种服务类型。rosservice type [service]</span></span><br><span class="line">rosservice call clear				<span class="comment">//代用clear服务，该服务清除了turtlesim_node的背景上的轨迹。rosservice call [service] [args]</span></span><br><span class="line">rosservice type spawn| rossrv show 	<span class="comment">//查看再生（spawn）服务的信息</span></span><br><span class="line">rosservice call spawn <span class="number">2</span> <span class="number">2</span> <span class="number">0.2</span> <span class="string">&quot;&quot;</span> 	<span class="comment">//调用再生服务，在给定的位置和角度生成一只新的乌龟。名字参数是可选的，这里我们不设具体的名字，让turtlesim自动创建一个。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rosparam set 						<span class="comment">//设置参数</span></span><br><span class="line">rosparam get 						<span class="comment">//获取参数</span></span><br><span class="line">rosparam load 						<span class="comment">//从文件读取参数</span></span><br><span class="line">rosparam dump 						<span class="comment">//向文件中写入参数</span></span><br><span class="line">rosparam <span class="keyword">delete</span> 					<span class="comment">//删除参数</span></span><br><span class="line">rosparam list 						<span class="comment">//列出节点在服务器上的参数名</span></span><br><span class="line">rosparam set background_r <span class="number">150</span>		<span class="comment">//修改背景颜色的红色通道。	rosparam set [param_name]</span></span><br><span class="line">rosservice call clear				<span class="comment">//上述指令修改了参数的值，现在我们调用清除服务使得修改后的参数生效</span></span><br><span class="line">rosparam get background_g			<span class="comment">//获取背景的绿色通道的值。 rosparam get [param_name]</span></span><br><span class="line">rosparam get /						<span class="comment">//显示参数服务器上的所有内容</span></span><br><span class="line">rosparam dump params.yaml 			<span class="comment">//将所有的参数写入params.yaml文件。 rosparam dump [file_name]</span></span><br><span class="line">rosparam load params.yaml copy		<span class="comment">//将yaml文件重载入新的命名空间，比如说copy空间。 rosparam load [file_name] [namespace]</span></span><br><span class="line">rosparam get copy/background_b		<span class="comment">//获取copy空间的蓝色背景参数</span></span><br></pre></td></tr></table></figure>
<h2 id="使用-rqt-console-和-roslaunch"><a href="#使用-rqt-console-和-roslaunch" class="headerlink" title="使用 rqt_console 和 roslaunch"></a>使用 rqt_console 和 roslaunch</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-kinetic-rqt ros-kinetic-rqt-common-plugins ros-kinetic-turtlesim</span><br><span class="line">														<span class="comment">//预先安装需要的程序包，若安装，请忽略</span></span><br><span class="line">rosrun rqt_console rqt_console							<span class="comment">//新终端中运行。 rqt_console属于ROS日志框架(logging framework)的一部分，用来显示节点的输出信息</span></span><br><span class="line">rosrun rqt_logger_level rqt_logger_level				<span class="comment">//新终端中运行。 rqt_logger_level允许我们修改节点运行时输出信息的日志等级（logger levels）（包括 DEBUG、WARN、INFO和ERROR）。</span></span><br><span class="line">rosrun turtlesim turtlesim_node							<span class="comment">//新终端中运行。启动turtlesim</span></span><br><span class="line">rostopic pub /turtle1/cmd_vel geometry_msgs/Twist -r <span class="number">1</span> -- <span class="string">&#x27;[2.0, 0.0, 0.0]&#x27;</span> <span class="string">&#x27;[0.0, 0.0, 0.0]&#x27;</span></span><br><span class="line">														<span class="comment">//小龟龟动起来再查看rqt_console中的输出</span></span><br><span class="line">roscd beginner_tutorials								<span class="comment">//打开之前创建的beginner_tutorials包，如果打不开，有两种办法解决：</span></span><br><span class="line">														<span class="comment">//1.输入绝对路径：cd ~/catkin_ws/src/beginner_tutorials	</span></span><br><span class="line">														<span class="comment">//2.设置当前终端环境路径：export ROS_PACKAGE_PATH=~/catkin_ws/src:$ROS_PACKAGE_PATH。 成功后再输入：roscd beginner_tutorials	</span></span><br><span class="line">mkdir launch &amp;&amp; cd launch 								<span class="comment">//创建并打开launch文件夹											</span></span><br></pre></td></tr></table></figure>
<p>新建一个空文件，命名为<code>turtlemimic.launch</code>，并在其中写入：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line"></span><br><span class="line">	&lt;group ns=<span class="string">&quot;turtlesim1&quot;</span>&gt;</span><br><span class="line"> 		&lt;node pkg=<span class="string">&quot;turtlesim&quot;</span> name=<span class="string">&quot;sim&quot;</span> type=<span class="string">&quot;turtlesim_node&quot;</span>/&gt;</span><br><span class="line"> 	&lt;/group&gt;</span><br><span class="line"></span><br><span class="line">	&lt;group ns=<span class="string">&quot;turtlesim2&quot;</span>&gt;</span><br><span class="line"> 		&lt;node pkg=<span class="string">&quot;turtlesim&quot;</span> name=<span class="string">&quot;sim&quot;</span> type=<span class="string">&quot;turtlesim_node&quot;</span>/&gt;</span><br><span class="line"> 	&lt;/group&gt;</span><br><span class="line"></span><br><span class="line"> 	&lt;node pkg=<span class="string">&quot;turtlesim&quot;</span> name=<span class="string">&quot;mimic&quot;</span> type=<span class="string">&quot;mimic&quot;</span>&gt;</span><br><span class="line">	 &lt;remap from=<span class="string">&quot;input&quot;</span> to=<span class="string">&quot;turtlesim1/turtle1&quot;</span>/&gt;</span><br><span class="line">	 &lt;remap from=<span class="string">&quot;output&quot;</span> to=<span class="string">&quot;turtlesim2/turtle1&quot;</span>/&gt;</span><br><span class="line"> 	&lt;/node&gt;</span><br><span class="line"></span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在3~9行我们创建了两个节点分组并以’命名空间（namespace)’标签来区分，其中一个名为turtulesim1，另一个名为turtlesim2，两个组里面都使用相同的turtlesim节点并命名为’sim’。这样可以让我们同时启动两个turtlesim模拟器而不会产生命名冲突。在11~14行我们启动模仿节点，并将所有话题的输入和输出分别重命名为turtlesim1和turtlesim2，这样就会使turtlesim2模仿turtlesim1。第1行和第16行分别表示luanch文件的开始标签和结束标签。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">roslaunch beginner_tutorials turtlemimic.launch			<span class="comment">//通过roslaunch命令启动launch文件，从而启动多个节点</span></span><br><span class="line">rostopic pub /turtlesim1/turtle1/cmd_vel geometry_msgs/Twist -r <span class="number">1</span> -- <span class="string">&#x27;[2.0, 0.0, 0.0]&#x27;</span> <span class="string">&#x27;[0.0, 0.0, -1.8]&#x27;</span></span><br><span class="line">														<span class="comment">//在一个新终端中使用rostopic命令发送速度设定消息</span></span><br></pre></td></tr></table></figure>
<h2 id="使用rosed编辑ROS中的文件"><a href="#使用rosed编辑ROS中的文件" class="headerlink" title="使用rosed编辑ROS中的文件"></a>使用rosed编辑ROS中的文件</h2><p>如果习惯使用emacs，需要先将emacs设为默认编辑器，如果习惯使用vim，需要安装vim。这里以设置emacs为例。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">emacs .bashrc				<span class="comment">//新开一个终端。在.bashrc文件的最后一行写入：export EDITOR=&#x27;emacs -nw&#x27;</span></span><br><span class="line">echo $EDITOR				<span class="comment">//打开一个新终端，看是否定义了EDITOR。注意：.bashrc文件的改变，只会在新的终端才有效。已经打开的终端不受环境变量的影响。正常情况下回输出:emacs -nw</span></span><br><span class="line">rosed roscpp Logger.msg 	<span class="comment">//rosed可以直接通过package名来获取到待编辑的文件而无需指定该文件的存储路径了. rosed [package_name] [filename]</span></span><br></pre></td></tr></table></figure>
<h2 id="创建ROS消息和ROS服务"><a href="#创建ROS消息和ROS服务" class="headerlink" title="创建ROS消息和ROS服务"></a>创建ROS消息和ROS服务</h2><h3 id="使用ROSmsg"><a href="#使用ROSmsg" class="headerlink" title="使用ROSmsg"></a>使用ROSmsg</h3><h4 id="创建一个rosmsg"><a href="#创建一个rosmsg" class="headerlink" title="创建一个rosmsg"></a>创建一个rosmsg</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/catkin_ws/src/beginner_tutorials			<span class="comment">//打开之前创建的package</span></span><br><span class="line">mkdir msg 										<span class="comment">//创建msg文件夹</span></span><br><span class="line">echo <span class="string">&quot;int64 num&quot;</span> &gt; msg/Num.msg 					<span class="comment">//写入到Num.msg文件中</span></span><br></pre></td></tr></table></figure>
<p>确保msg文件被转为C++，Python和其他语言的源代码。查看package.xml, 确保它包含以下两条语句。若没有，手动添加。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;</span><br><span class="line">&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;</span><br></pre></td></tr></table></figure>
<h4 id="修改-beginner-tutorials-CMakeLists-txt"><a href="#修改-beginner-tutorials-CMakeLists-txt" class="headerlink" title="修改./beginner_tutorials/CMakeLists.txt:"></a>修改./beginner_tutorials/CMakeLists.txt:</h4><p>1.寻找find_package，向其中添加message_generation。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find_package</span>(catkin REQUIRED COMPONENTS </span><br><span class="line">	         roscpp </span><br><span class="line">	         rospy </span><br><span class="line">	         std_msgs </span><br><span class="line">	         message_generation</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>2.寻找catkin_package，设置运行依赖。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">catkin_package</span>(</span><br><span class="line">#  INCLUDE_DIRS include</span><br><span class="line">#  LIBRARIES beginner_tutorials</span><br><span class="line">#  CATKIN_DEPENDS roscpp rospy std_msgs</span><br><span class="line">#  DEPENDS system_lib</span><br><span class="line">  CATKIN_DEPENDS message_runtime</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>3.将add_message_files代码块去掉注释，并用自己的Num.msg代替Messag1.msg，如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add_message_files</span>(</span><br><span class="line">   FILES</span><br><span class="line">   Num.msg</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>4.取消generate_messages()的注释，如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">generate_messages</span>(</span><br><span class="line">   DEPENDENCIES</span><br><span class="line">   std_msgs</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="使用rosmsg"><a href="#使用rosmsg" class="headerlink" title="使用rosmsg"></a>使用rosmsg</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rosmsg show beginner_tutorials/Num 				<span class="comment">//通过rosmsg show命令，检查ROS是否能够识消息。正确情况下会输出：int64 num。</span></span><br><span class="line">												<span class="comment">//如果不正常，需要设置path，输入指令：export ROS_PACKAGE_PATH=~/catkin_ws/src:$ROS_PACKAGE_PATH。再次输入show命令。</span></span><br></pre></td></tr></table></figure>
<h3 id="使用ROSsrv"><a href="#使用ROSsrv" class="headerlink" title="使用ROSsrv"></a>使用ROSsrv</h3><h4 id="创建一个srv"><a href="#创建一个srv" class="headerlink" title="创建一个srv"></a>创建一个srv</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">roscd beginner_tutorials</span><br><span class="line">mkdir srv</span><br><span class="line">roscp rospy_tutorials AddTwoInts.srv srv/AddTwoInts.srv</span><br><span class="line">												<span class="comment">//roscp [package_name] [file_to_copy_path] [copy_path]</span></span><br><span class="line">												<span class="comment">//roscp是一个很实用的命令行工具，它实现了将文件从一个package复制到另外一个package的功能。</span></span><br></pre></td></tr></table></figure>
<p>同样，需要确保srv文件被转换为C++和其他语言的源代码。</p>
<h4 id="修改CMakeLists-txt"><a href="#修改CMakeLists-txt" class="headerlink" title="修改CMakeLists.txt:"></a>修改CMakeLists.txt:</h4><p>1.和ROSmsg一样添加对message_generation的依赖。(message_generation 对msg和srv都起作用)</p>
<p>2.将add_message_files代码块去掉注释，并添加自己的srv文件，如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">add_service_files</span>(</span><br><span class="line">   FILES</span><br><span class="line">   AddTwoInts.srv</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>3.取消generate_messages()的注释，同ROSmsg，如下：</p>
<h4 id="使用ROSsrv-1"><a href="#使用ROSsrv-1" class="headerlink" title="使用ROSsrv"></a>使用ROSsrv</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rossrv show beginner_tutorials/AddTwoInts 		<span class="comment">//通过rosmsg show命令，检查ROS是否能够识该服务。 rossrv show &lt;service type&gt;。跟rosmsg类似, 你也可以不指定具体的package名来查找服务文件</span></span><br></pre></td></tr></table></figure>
<h3 id="新开一个终端，打开工作空间并编译："><a href="#新开一个终端，打开工作空间并编译：" class="headerlink" title="新开一个终端，打开工作空间并编译："></a>新开一个终端，打开工作空间并编译：</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd catkin_ws</span><br><span class="line">catkin_make</span><br></pre></td></tr></table></figure>
<p>所有在msg路径下的.msg文件都将转换为ROS所支持语言的源代码。生成的C++头文件将会放置在~/catkin_ws/devel/include/beginner_tutorials。</p>
<h2 id="编写简单的消息发布器和订阅器-C"><a href="#编写简单的消息发布器和订阅器-C" class="headerlink" title="编写简单的消息发布器和订阅器 (C++)"></a>编写简单的消息发布器和订阅器 (C++)</h2><p>创建一个发布器节点(“talker”)，它将不断的在ROS网络中广播消息。创建一个接收器节点(“listener”)，它来接收ROS网络中的广播消息。</p>
<h3 id="beginner-tutorials-src-talker-cpp"><a href="#beginner-tutorials-src-talker-cpp" class="headerlink" title="./beginner_tutorials/src/talker.cpp"></a>./beginner_tutorials/src/talker.cpp</h3><blockquote>
<p>为了减少篇幅，将源码中的大段英文注释删除。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span>					<span class="comment">//ros/ros.h 是一个实用的头文件，它引用了 ROS 系统中大部分常用的头文件。</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/String.h&quot;</span>			<span class="comment">//这引用了 std_msgs/String 消息, 它存放在 std_msgs package 里，是由 String.msg 文件自动生成的头文件。</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This tutorial demonstrates simple sending of messages over the ROS system.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">  ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;talker&quot;</span>);		<span class="comment">//初始化 ROS 。它允许 ROS 通过命令行进行名称重映射——然而这并不是现在讨论的重点。在这里，我们也可以指定节点的名称——运行过程中，节点的名称必须唯一。</span></span><br><span class="line">										<span class="comment">//这里的名称必须是一个 base name ，也就是说，名称内不能包含 / 等符号。</span></span><br><span class="line"></span><br><span class="line">  ros::NodeHandle n;					<span class="comment">//为这个进程的节点创建一个句柄。第一个创建的 NodeHandle 会为节点进行初始化，最后一个销毁的 NodeHandle 则会释放该节点所占用的所有资源。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   *告诉 master 我们将要在 chatter（话题名） 上发布 std_msgs/String 消息类型的消息。这样 master 就会告诉所有订阅了 chatter *话题的节点，将要有数据发布。第二个参数是发布序列的大小。如果我们发布的消息的频率太高，缓冲区中的消息在大于 1000 个的时候就会开始丢弃先前发布的消息。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   *NodeHandle::advertise() 返回一个 ros::Publisher 对象,它有两个作用： 1) 它有一个 publish() 成员函数可以让你在topic上发布消息； 2) 如果消息类型不对,它会拒绝发布。</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  ros::Publisher chatter_pub = n.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">&quot;chatter&quot;</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function">ros::Rate <span class="title">loop_rate</span><span class="params">(<span class="number">10</span>)</span></span>;				<span class="comment">//ros::Rate 对象可以允许你指定自循环的频率。它会追踪记录自上一次调用 Rate::sleep() 后时间的流逝，并休眠直到一个频率周期的时间。这个例子中，我们让它以 10Hz 的频率运行。</span></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())						<span class="comment">//roscpp 会默认生成一个 SIGINT 句柄，它负责处理 Ctrl-C 键盘操作——使得 ros::ok() 返回 false。</span></span><br><span class="line">  &#123;</span><br><span class="line">    std_msgs::String msg;				<span class="comment">//使用一个由 msg file 文件产生的『消息自适应』类在 ROS 网络中广播消息。现在我们使用标准的String消息，它只有一个数据成员 &quot;data&quot;。</span></span><br><span class="line"></span><br><span class="line">    std::stringstream ss;</span><br><span class="line">    ss &lt;&lt; <span class="string">&quot;hello world &quot;</span> &lt;&lt; count;</span><br><span class="line">    msg.data = ss.<span class="built_in">str</span>();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;%s&quot;</span>, msg.data.<span class="built_in">c_str</span>());	<span class="comment">//ROS_INFO 和其他类似的函数可以用来代替 printf/cout 等函数。</span></span><br><span class="line"></span><br><span class="line">    chatter_pub.<span class="built_in">publish</span>(msg);			<span class="comment">//向所有订阅 chatter 话题的节点发送消息。</span></span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">spinOnce</span>();					<span class="comment">//在这个例子中并不是一定要调用 ros::spinOnce()，因为我们不接受回调。然而，如果你的程序里包含其他回调函数，最好在这里加上 </span></span><br><span class="line">    									<span class="comment">//ros::spinOnce()这一语句，否则你的回调函数就永远也不会被调用了。				</span></span><br><span class="line"></span><br><span class="line">    loop_rate.<span class="built_in">sleep</span>();					<span class="comment">//调用 ros::Rate 对象来休眠一段时间以使得发布频率为 10Hz。</span></span><br><span class="line">    ++count;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="beginner-tutorials-src-listener-cpp"><a href="#beginner-tutorials-src-listener-cpp" class="headerlink" title="./beginner_tutorials/src/listener.cpp"></a>./beginner_tutorials/src/listener.cpp</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;std_msgs/String.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This tutorial demonstrates simple receipt of messages over the ROS system.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">chatterCallback</span><span class="params">(<span class="type">const</span> std_msgs::String::ConstPtr&amp; msg)</span>				<span class="comment">//这是一个回调函数，当接收到 chatter 话题的时候就会被调用。消息是以 boost shared_ptr 指针的形式传输，这就意味着你可以存储它而又不需要复制数据。</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">ROS_INFO</span>(<span class="string">&quot;I heard: [%s]&quot;</span>, msg-&gt;data.<span class="built_in">c_str</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">  ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;listener&quot;</span>);</span><br><span class="line"></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 告诉 master 我们要订阅 chatter 话题上的消息。当有消息发布到这个话题时，ROS 就会调用 chatterCallback() 函数。第二个参数是队列大小，以防我们处理消息的速度不够快，当缓存达到 1000 </span></span><br><span class="line"><span class="comment">   * 条消息后，再有新的消息到来就将开始丢弃先前接收的消息。</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * NodeHandle::subscribe() 返回 ros::Subscriber 对象,你必须让它处于活动状态直到你不再想订阅该消息。当这个对象销毁时，它将自动退订 chatter 话题的消息。</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * 有各种不同的 NodeHandle::subscribe() 函数，允许你指定类的成员函数，甚至是 Boost.Function 对象可以调用的任何数据类型。</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  ros::Subscriber sub = n.<span class="built_in">subscribe</span>(<span class="string">&quot;chatter&quot;</span>, <span class="number">1000</span>, chatterCallback);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ros::spin() 进入自循环，可以尽可能快的调用消息回调函数。如果没有消息到达，它不会占用很多 CPU，所以不用担心。一旦 ros::ok() 返回 false，ros::spin() 就会立刻跳出自循环。</span></span><br><span class="line"><span class="comment">   * 这有可能是 ros::shutdown() 被调用，或者是用户按下了 Ctrl-C，使得 master 告诉节点要终止运行。也有可能是节点被人为关闭的。</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下边，我们来总结一下:</p>
<ul>
<li>初始化ROS系统</li>
<li>订阅 chatter 话题</li>
<li>进入自循环，等待消息的到达</li>
<li>当消息到达，调用 chatterCallback() 函数</li>
</ul>
<h3 id="beginner-tutorials-CMakeLists-txt"><a href="#beginner-tutorials-CMakeLists-txt" class="headerlink" title="./beginner_tutorials/CMakeLists.txt"></a>./beginner_tutorials/CMakeLists.txt</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION <span class="number">2.8</span><span class="number">.3</span>)</span><br><span class="line">project(beginner_tutorials)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Find catkin and any catkin packages</span></span><br><span class="line">find_package(catkin REQUIRED COMPONENTS roscpp rospy std_msgs genmsg)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Declare ROS messages and services</span></span><br><span class="line">add_message_files(FILES Num.msg)</span><br><span class="line">add_service_files(FILES AddTwoInts.srv)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Generate added messages and services</span></span><br><span class="line">generate_messages(DEPENDENCIES std_msgs)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Declare a catkin package</span></span><br><span class="line">catkin_package()</span><br><span class="line"></span><br><span class="line"><span class="comment">## Build talker and listener</span></span><br><span class="line">include_directories(include $&#123;catkin_INCLUDE_DIRS&#125;)</span><br><span class="line"></span><br><span class="line">add_executable(talker src/talker.cpp)</span><br><span class="line">target_link_libraries(talker $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(talker beginner_tutorials_generate_messages_cpp)</span><br><span class="line"></span><br><span class="line">add_executable(listener src/listener.cpp)</span><br><span class="line">target_link_libraries(listener $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(listener beginner_tutorials_generate_messages_cpp)</span><br></pre></td></tr></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>在工作空间目录下进行编译，并运行。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">roscore									<span class="comment">//新开一个终端</span></span><br><span class="line">cd catkin_ws							<span class="comment">//新开一个终端</span></span><br><span class="line">catkin_make</span><br><span class="line">source ./devel/setup.bash       		<span class="comment">//在运行你自己的程序前，已经source了catkin工作空间下的setup.sh文件</span></span><br><span class="line">rosrun beginner_tutorials talker 		<span class="comment">//启动发布器</span></span><br><span class="line"></span><br><span class="line">cd catkin_ws							<span class="comment">//新开一个终端，并打开工作空间</span></span><br><span class="line">source ./devel/setup.bash       		<span class="comment">//在运行你自己的程序前，已经source了catkin工作空间下的setup.sh文件</span></span><br><span class="line">rosrun beginner_tutorials listener 		<span class="comment">//启动订阅器</span></span><br></pre></td></tr></table></figure>
<h2 id="编写简单的服务器和客户端-C"><a href="#编写简单的服务器和客户端-C" class="headerlink" title="编写简单的服务器和客户端(C++)"></a>编写简单的服务器和客户端(C++)</h2><h3 id="beginner-tutorials-src-add-two-ints-server-cpp"><a href="#beginner-tutorials-src-add-two-ints-server-cpp" class="headerlink" title="./beginner_tutorials/src/add_two_ints_server.cpp"></a>./beginner_tutorials/src/add_two_ints_server.cpp</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;beginner_tutorials/AddTwoInts.h&quot;</span>								<span class="comment">//beginner_tutorials/AddTwoInts.h是由编译系统自动根据我们先前创建的srv文件生成的对应该srv文件的头文件。</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 这个函数提供两个int值求和的服务，int值从request里面获取，而返回数据装入response内，这些数据类型都定义在srv文件内部，函数返回一个boolean值。</span></span><br><span class="line"><span class="comment">  * 两个int值进行相加，并存入response。然后一些关于request和response的信息被记录下来。最后，service完成计算后返回true值。</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">add</span><span class="params">(beginner_tutorials::AddTwoInts::Request  &amp;req,</span></span></span><br><span class="line"><span class="params"><span class="function">         beginner_tutorials::AddTwoInts::Response &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  res.sum = req.a + req.b;</span><br><span class="line">  <span class="built_in">ROS_INFO</span>(<span class="string">&quot;request: x=%ld, y=%ld&quot;</span>, (<span class="type">long</span> <span class="type">int</span>)req.a, (<span class="type">long</span> <span class="type">int</span>)req.b);</span><br><span class="line">  <span class="built_in">ROS_INFO</span>(<span class="string">&quot;sending back response: [%ld]&quot;</span>, (<span class="type">long</span> <span class="type">int</span>)res.sum);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;add_two_ints_server&quot;</span>);</span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line"></span><br><span class="line">  ros::ServiceServer service = n.<span class="built_in">advertiseService</span>(<span class="string">&quot;add_two_ints&quot;</span>, add);	<span class="comment">//建立service，并在ROS内发布出来。</span></span><br><span class="line">  <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Ready to add two ints.&quot;</span>);</span><br><span class="line">  ros::<span class="built_in">spin</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="beginner-tutorials-src-add-two-ints-client-cpp"><a href="#beginner-tutorials-src-add-two-ints-client-cpp" class="headerlink" title="./beginner_tutorials/src/add_two_ints_client.cpp"></a>./beginner_tutorials/src/add_two_ints_client.cpp</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ros/ros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;beginner_tutorials/AddTwoInts.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ros::<span class="built_in">init</span>(argc, argv, <span class="string">&quot;add_two_ints_client&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (argc != <span class="number">3</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;usage: add_two_ints_client X Y&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ros::NodeHandle n;</span><br><span class="line">  ros::ServiceClient client = n.<span class="built_in">serviceClient</span>&lt;beginner_tutorials::AddTwoInts&gt;(<span class="string">&quot;add_two_ints&quot;</span>);		<span class="comment">//这段代码为add_two_ints service创建一个client。ros::ServiceClient 对象待会用来调用service。</span></span><br><span class="line">  beginner_tutorials::AddTwoInts srv;																<span class="comment">//这里，我们实例化一个由ROS编译系统自动生成的service类，并给其request成员赋值。</span></span><br><span class="line">  srv.request.a = <span class="built_in">atoll</span>(argv[<span class="number">1</span>]);																	<span class="comment">// 一个service类包含两个成员request和response。同时也包括两个类定义Request和Response。</span></span><br><span class="line">  srv.request.b = <span class="built_in">atoll</span>(argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 这段代码是在调用service。由于service的调用是模态过程（调用的时候占用进程阻止其他代码的执行），一旦调用完成，将返回调用结果。</span></span><br><span class="line"><span class="comment">   * 如果service调用成功，call()函数将返回true，srv.response里面的值将是合法的值。</span></span><br><span class="line"><span class="comment">   * 如果调用失败，call()函数将返回false，srv.response里面的值将是非法的。 </span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">if</span> (client.<span class="built_in">call</span>(srv))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">&quot;Sum: %ld&quot;</span>, (<span class="type">long</span> <span class="type">int</span>)srv.response.sum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">ROS_ERROR</span>(<span class="string">&quot;Failed to call service add_two_ints&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="beginner-tutorials-CMakeLists-txt-1"><a href="#beginner-tutorials-CMakeLists-txt-1" class="headerlink" title="./beginner_tutorials/CMakeLists.txt"></a>./beginner_tutorials/CMakeLists.txt</h3><p>在上一节的CMakeLists.txt后添加：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add_executable(add_two_ints_server src/add_two_ints_server.cpp)</span><br><span class="line">target_link_libraries(add_two_ints_server $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(add_two_ints_server beginner_tutorials_gencpp)</span><br><span class="line"></span><br><span class="line">add_executable(add_two_ints_client src/add_two_ints_client.cpp)</span><br><span class="line">target_link_libraries(add_two_ints_client $&#123;catkin_LIBRARIES&#125;)</span><br><span class="line">add_dependencies(add_two_ints_client beginner_tutorials_gencpp)</span><br></pre></td></tr></table></figure>
<h3 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h3><p>在工作空间目录下进行编译，并运行。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">roscore												<span class="comment">//新开一个终端</span></span><br><span class="line">cd catkin_ws										<span class="comment">//新开一个终端</span></span><br><span class="line">catkin_make</span><br><span class="line">source ./devel/setup.bash       					<span class="comment">//在运行你自己的程序前，已经source了catkin工作空间下的setup.sh文件</span></span><br><span class="line">rosrun beginner_tutorials add_two_ints_server 		<span class="comment">//启动服务器</span></span><br><span class="line"></span><br><span class="line">cd catkin_ws										<span class="comment">//新开一个终端，并打开工作空间</span></span><br><span class="line">source ./devel/setup.bash       					<span class="comment">//在运行你自己的程序前，已经source了catkin工作空间下的setup.sh文件</span></span><br><span class="line">rosrun beginner_tutorials add_two_ints_client <span class="number">1</span> <span class="number">3</span> 	<span class="comment">//启动客户端</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>ROS(kinetic)有用指令集</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://colainlibrary.com/archives/25595.html">https://colainlibrary.com/archives/25595.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>Cola &amp; Library</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2019-08-03</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2022-08-18</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Library/">Library</a><a class="post-meta__tags" href="/tags/%E6%9C%BA%E5%99%A8%E4%BA%BA/">机器人</a><a class="post-meta__tags" href="/tags/ROS/">ROS</a></div><div class="post_share"><div class="social-share" data-image="/images/post-9.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/images/wechatpay.png" target="_blank"><img class="post-qr-code-img" src="/images/wechatpay.png" alt="微信支付"/></a><div class="post-qr-code-desc">微信支付</div></li><li class="reward-item"><a href="/images/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/images/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/archives/56535.html"><img class="prev-cover" src="/images/post-0.jpg" onerror="onerror=null;src='/images/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux下OpenCV库的安装</div></div></a></div><div class="next-post pull-right"><a href="/archives/48591.html"><img class="next-cover" src="/images/post-8.jpg" onerror="onerror=null;src='/images/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">VMware下Ubuntu的磁盘扩容问题</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/archives/5258b4f6.html" title="ROS仿真揭秘——七自由度机器人(五)"><img class="cover" src="/images/post-6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-27</div><div class="title">ROS仿真揭秘——七自由度机器人(五)</div></div></a></div><div><a href="/archives/54f3e38b.html" title="ROS仿真揭秘——七自由度机器人(四)"><img class="cover" src="/images/post-5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-26</div><div class="title">ROS仿真揭秘——七自由度机器人(四)</div></div></a></div><div><a href="/archives/634af183.html" title="ROS仿真揭秘——七自由度机器人(三)"><img class="cover" src="/images/post-4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-25</div><div class="title">ROS仿真揭秘——七自由度机器人(三)</div></div></a></div><div><a href="/archives/d0432caf.html" title="ROS仿真揭秘——七自由度机器人(二)"><img class="cover" src="/images/post-3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-24</div><div class="title">ROS仿真揭秘——七自由度机器人(二)</div></div></a></div><div><a href="/archives/cf0a378a.html" title="ros_control介绍"><img class="cover" src="/images/post-1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-21</div><div class="title">ros_control介绍</div></div></a></div><div><a href="/archives/92e37bf7.html" title="ROS节点之间基本的通讯方式介绍"><img class="cover" src="/images/post-0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-20</div><div class="title">ROS节点之间基本的通讯方式介绍</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.jpg" onerror="this.onerror=null;this.src='/images/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cola &amp; Library</div><div class="author-info__description">Understand, don't memorize.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">如果阅读过程中有任何疑问，欢迎评论或留言，看到后会及时回复。</div><div class="xpand" style="height:200px;"><canvas class="illo" width="800" height="800" style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas></div></div><script src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople1.js"></script><script src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/zdog.dist.js"></script><script id="rendered-js" src="https://fastly.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople.js"></script><style>.card-widget.card-announcement {
margin: 0;
align-items: center;
justify-content: center;
text-align: center;
}
canvas {
display: block;
margin: 0 auto;
cursor: move;
}</style><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4%E4%BB%8B%E7%BB%8D"><span class="toc-text">指令介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E5%AE%89%E8%A3%85%E6%8C%87%E4%BB%A4"><span class="toc-text">ROS安装指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UR5%E7%9A%84%E4%BB%BF%E7%9C%9F%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-text">UR5的仿真环境安装与使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BB%8B%E7%BB%8D"><span class="toc-text">ROS文件系统介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8catkin%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4"><span class="toc-text">使用catkin创建工作空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAROS%E7%A8%8B%E5%BA%8F%E5%8C%85"><span class="toc-text">创建ROS程序包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91ROS%E7%A8%8B%E5%BA%8F%E5%8C%85"><span class="toc-text">编译ROS程序包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3ROS%E8%8A%82%E7%82%B9"><span class="toc-text">理解ROS节点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3ROS%E8%AF%9D%E9%A2%98"><span class="toc-text">理解ROS话题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3ROS%E6%9C%8D%E5%8A%A1%E5%92%8C%E5%8F%82%E6%95%B0"><span class="toc-text">理解ROS服务和参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-rqt-console-%E5%92%8C-roslaunch"><span class="toc-text">使用 rqt_console 和 roslaunch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8rosed%E7%BC%96%E8%BE%91ROS%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-text">使用rosed编辑ROS中的文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAROS%E6%B6%88%E6%81%AF%E5%92%8CROS%E6%9C%8D%E5%8A%A1"><span class="toc-text">创建ROS消息和ROS服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ROSmsg"><span class="toc-text">使用ROSmsg</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AArosmsg"><span class="toc-text">创建一个rosmsg</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-beginner-tutorials-CMakeLists-txt"><span class="toc-text">修改.&#x2F;beginner_tutorials&#x2F;CMakeLists.txt:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8rosmsg"><span class="toc-text">使用rosmsg</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ROSsrv"><span class="toc-text">使用ROSsrv</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAsrv"><span class="toc-text">创建一个srv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9CMakeLists-txt"><span class="toc-text">修改CMakeLists.txt:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8ROSsrv-1"><span class="toc-text">使用ROSsrv</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BC%80%E4%B8%80%E4%B8%AA%E7%BB%88%E7%AB%AF%EF%BC%8C%E6%89%93%E5%BC%80%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E5%B9%B6%E7%BC%96%E8%AF%91%EF%BC%9A"><span class="toc-text">新开一个终端，打开工作空间并编译：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E7%9A%84%E6%B6%88%E6%81%AF%E5%8F%91%E5%B8%83%E5%99%A8%E5%92%8C%E8%AE%A2%E9%98%85%E5%99%A8-C"><span class="toc-text">编写简单的消息发布器和订阅器 (C++)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-src-talker-cpp"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;src&#x2F;talker.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-src-listener-cpp"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;src&#x2F;listener.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-CMakeLists-txt"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;CMakeLists.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF-C"><span class="toc-text">编写简单的服务器和客户端(C++)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-src-add-two-ints-server-cpp"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;src&#x2F;add_two_ints_server.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-src-add-two-ints-client-cpp"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;src&#x2F;add_two_ints_client.cpp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beginner-tutorials-CMakeLists-txt-1"><span class="toc-text">.&#x2F;beginner_tutorials&#x2F;CMakeLists.txt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-text">测试</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/10259deb.html" title="Hexo-Butterfly 多图排版"><img src="/images/post-2.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="Hexo-Butterfly 多图排版"/></a><div class="content"><a class="title" href="/archives/10259deb.html" title="Hexo-Butterfly 多图排版">Hexo-Butterfly 多图排版</a><time datetime="2022-08-19T15:00:00.000Z" title="发表于 2022-08-19 15:00:00">2022-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/f301cdf2.html" title="外挂标签的使用"><img src="/images/post-1.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="外挂标签的使用"/></a><div class="content"><a class="title" href="/archives/f301cdf2.html" title="外挂标签的使用">外挂标签的使用</a><time datetime="2022-08-18T22:00:00.000Z" title="发表于 2022-08-18 22:00:00">2022-08-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/c12048c3.html" title="Pytorch 学习笔记（梯度的求取）"><img src="/images/post-0.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="Pytorch 学习笔记（梯度的求取）"/></a><div class="content"><a class="title" href="/archives/c12048c3.html" title="Pytorch 学习笔记（梯度的求取）">Pytorch 学习笔记（梯度的求取）</a><time datetime="2022-08-14T15:00:00.000Z" title="发表于 2022-08-14 15:00:00">2022-08-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/fa516be2.html" title="cmake生成动态链接库并调用"><img src="/images/post-9.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="cmake生成动态链接库并调用"/></a><div class="content"><a class="title" href="/archives/fa516be2.html" title="cmake生成动态链接库并调用">cmake生成动态链接库并调用</a><time datetime="2022-08-13T13:00:00.000Z" title="发表于 2022-08-13 13:00:00">2022-08-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/9765ce4r.html" title="Numpy 学习笔记"><img src="/images/post-8.jpg" onerror="this.onerror=null;this.src='/images/404.jpg'" alt="Numpy 学习笔记"/></a><div class="content"><a class="title" href="/archives/9765ce4r.html" title="Numpy 学习笔记">Numpy 学习笔记</a><time datetime="2022-08-11T11:00:00.000Z" title="发表于 2022-08-11 11:00:00">2022-08-11</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/images/post-9.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By Cola & Library</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'owryKYMxVRpqksq7EoJmoJHy-gzGzoHsz',
      appKey: 'W7BaIi1FbwpgIDuNXyGAfUsl',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async src="//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>