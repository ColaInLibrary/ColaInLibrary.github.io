<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hexo-Butterfly 多图排版</title>
    <url>/archives/10259deb.html</url>
    <content><![CDATA[<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h1><p>Butterfly 主题自带的照片墙排版方式可以对多图并排，但是要求预先对图片尺寸设计好，也就是不能自行修改图片尺寸，体验不好；网上流传的各种 html 标签的写法要么不能正常显示，要么不能实现多图并排。笔者在此引入一种可以实现多图并排、并能调整大小的方式。该方式通过构建外挂标签，实现多图并排。因为笔者之前使用 Next 主题样式是比较容易实现多图并排的，因此就从 Next 主题中找出了相关的文件。</p>
<h1 id="2-多图并排的实现方式"><a href="#2-多图并排的实现方式" class="headerlink" title="2 多图并排的实现方式"></a>2 多图并排的实现方式</h1><h2 id="2-1-创建-group-pictures-js"><a href="#2-1-创建-group-pictures-js" class="headerlink" title="2.1 创建 group-pictures.js"></a>2.1 创建 group-pictures.js</h2><p>在<code>themes/butterfly/scripts/tag/</code>目录下创建<code>group-pictures.js</code>文件，并写入：<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* global hexo */</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">LAYOUTS</span> = &#123;</span><br><span class="line">  <span class="number">2</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">2</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">3</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">3</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">4</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">5</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">6</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">5</span>: [<span class="number">3</span>, <span class="number">3</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">7</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">5</span>: [<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">8</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">5</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">6</span>: [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">7</span>: [<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">9</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">5</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">6</span>: [<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">7</span>: [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">10</span>: &#123;</span><br><span class="line">    <span class="number">1</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">2</span>: [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">3</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">4</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">5</span>: [<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="number">6</span>: [<span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="number">7</span>: [<span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">groupBy</span>(<span class="params">group, data</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> r = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> count <span class="keyword">of</span> group) &#123;</span><br><span class="line">    r.<span class="title function_">push</span>(data.<span class="title function_">slice</span>(<span class="number">0</span>, count));</span><br><span class="line">    data = data.<span class="title function_">slice</span>(count);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> templates = &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attr">dispatch</span>: <span class="keyword">function</span>(<span class="params">pictures, group, layout</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> rule = <span class="variable constant_">LAYOUTS</span>[group] ? <span class="variable constant_">LAYOUTS</span>[group][layout] : <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> rule ? <span class="variable language_">this</span>.<span class="title function_">getHTML</span>(<span class="title function_">groupBy</span>(rule, pictures)) : templates.<span class="title function_">defaults</span>(pictures);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Defaults Layout</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * □ □ □</span></span><br><span class="line"><span class="comment">   * □ □ □</span></span><br><span class="line"><span class="comment">   * ...</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> <span class="variable">pictures</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">defaults</span>: <span class="keyword">function</span>(<span class="params">pictures</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable constant_">ROW_SIZE</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">var</span> rows = pictures.<span class="property">length</span> / <span class="variable constant_">ROW_SIZE</span>;</span><br><span class="line">    <span class="keyword">var</span> pictureArr = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; rows; i++) &#123;</span><br><span class="line">      pictureArr.<span class="title function_">push</span>(pictures.<span class="title function_">slice</span>(i * <span class="variable constant_">ROW_SIZE</span>, (i + <span class="number">1</span>) * <span class="variable constant_">ROW_SIZE</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">getHTML</span>(pictureArr);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">getHTML</span>: <span class="keyword">function</span>(<span class="params">rows</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> rowHTML = rows.<span class="title function_">map</span>(<span class="function"><span class="params">row</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;group-picture-row&quot;&gt;<span class="subst">$&#123;<span class="variable language_">this</span>.getColumnHTML(row)&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">    &#125;).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;group-picture-container&quot;&gt;<span class="subst">$&#123;rowHTML&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">getColumnHTML</span>: <span class="keyword">function</span>(<span class="params">pictures</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> columnWidth = <span class="number">100</span> / pictures.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">var</span> columnStyle = <span class="string">`style=&quot;width: <span class="subst">$&#123;columnWidth&#125;</span>%;&quot;`</span>;</span><br><span class="line">    <span class="keyword">return</span> pictures.<span class="title function_">map</span>(<span class="function"><span class="params">picture</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;group-picture-column&quot; <span class="subst">$&#123;columnStyle&#125;</span>&gt;<span class="subst">$&#123;picture&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">    &#125;).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">groupPicture</span>(<span class="params">args, content</span>) &#123;</span><br><span class="line">  args = args[<span class="number">0</span>].<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> group = <span class="built_in">parseInt</span>(args[<span class="number">0</span>], <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">var</span> layout = <span class="built_in">parseInt</span>(args[<span class="number">1</span>], <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  content = hexo.<span class="property">render</span>.<span class="title function_">renderSync</span>(&#123;<span class="attr">text</span>: content, <span class="attr">engine</span>: <span class="string">&#x27;markdown&#x27;</span>&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> pictures = content.<span class="title function_">match</span>(<span class="regexp">/&lt;img[\s\S]*?&gt;/g</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;div class=&quot;group-picture&quot;&gt;<span class="subst">$&#123;templates.dispatch(pictures, group, layout)&#125;</span>&lt;/div&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;grouppicture&#x27;</span>, groupPicture, &#123;<span class="attr">ends</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;gp&#x27;</span>, groupPicture, &#123;<span class="attr">ends</span>: <span class="literal">true</span>&#125;);</span><br></pre></td></tr></table></figure><br><div class="note info modern"><p>该文件来自<code>themes/next/scripts/tags/group-pictures.js</code>。</p>
</div></p>
<h2 id="2-2-创建-group-pictures-styl"><a href="#2-2-创建-group-pictures-styl" class="headerlink" title="2.2 创建 group-pictures.styl"></a>2.2 创建 group-pictures.styl</h2><p>在<code>themes/butterfly/source/css/_tags</code>目录下创建<code>group-pictures.styl</code>文件，并写入：<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.post-body .group-picture img &#123;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  padding: 0 3px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.group-picture-row &#123;</span><br><span class="line">  margin-bottom: 6px;</span><br><span class="line">  overflow: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.group-picture-column &#123;</span><br><span class="line">  float: left;</span><br><span class="line">  margin-bottom: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page-post-detail .post-body .group-picture-column &#123;</span><br><span class="line">  // float: none;</span><br><span class="line">  margin-top: 10px;</span><br><span class="line">  // width: auto !important;</span><br><span class="line">  img &#123; margin: 0 auto; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><div class="note info modern"><p>该文件来自<code>themes/next/source/css/_common/scaffolding/tags/group-pictures.styl</code>。</p>
</div></p>
<h2 id="2-3-使用方法"><a href="#2-3-使用方法" class="headerlink" title="2.3 使用方法"></a>2.3 使用方法</h2><p>更多的使用效果见：<br><div class="tag link"><a class="link-card" title="多图排版issue" href="https://github.com/iissnan/hexo-theme-next/issues/295"><div class="left"><img src="/images/github.png"/></div><div class="right"><p class="text">多图排版issue</p><p class="url">https://github.com/iissnan/hexo-theme-next/issues/295</p></div></a></div></p>
<p>布局格式可参考下图（个别布局顺序有出入）：<br><img src="/images/20220816/layout.png" alt="layout"><br><div class="note warning modern"><p>warning:<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](<span class="link"></span>)</span><br></pre></td></tr></table></figure><br>在用语法添加本地路径的图片时，注意()内要先写个空格再加<code>/images/xxx.png</code>，不然有可能会提示<span class='p red'>Markdown Image Path does not exists!</span>。虽然这个并不影响图片的显示。 </p>
</div></p>
<p>使用模板：<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 2-1 %&#125; </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;...&quot;</span> <span class="attr">width</span> = <span class="string">xxx</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;...&quot;</span> <span class="attr">width</span> = <span class="string">xxx</span> <span class="attr">alt</span>=<span class="string">&quot;box-y&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure><br><div class="note info modern"><p><code>gp 2-1</code> 即2张图按第1种格式排版。</p>
</div></p>
<div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">双图效果</button></li><li class="tab"><button type="button" data-href="#test4-2">实现代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><div class="note primary simple"><p>默认大小，gp 2-2 或者 gp 2-0 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt="box-x" align=center /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt="box-x" align=center /></div></div></div></div>
<div class="note primary simple"><p>自定义大小并调整位置使双图间无缝隙，gp 2-2 或者 gp 2-0 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" width = "250" alt="box-x" align=right /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" width = "250" alt="box-x" align=left /></div></div></div></div>
<div class="note primary simple"><p>gp 2-1 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" width = 40% align=center /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" width = 40% align=center /></div></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><div class="note primary simple"><p>默认大小，gp 2-2 或者 gp 2-0 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 2-0 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p>
<p><div class="note primary simple"><p>自定义大小，gp 2-2 或者 gp 2-0 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 2-0 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg&quot;</span> <span class="attr">width</span> = <span class="string">&quot;250&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">right</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg&quot;</span> <span class="attr">width</span> = <span class="string">&quot;250&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">left</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p>
<p><div class="note primary simple"><p>gp 2-1 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 2-1 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg&quot;</span> <span class="attr">width</span> = <span class="string">&quot;100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span>  <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg&quot;</span> <span class="attr">width</span> = <span class="string">&quot;100&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span>  <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">三图效果</button></li><li class="tab"><button type="button" data-href="#test4-2">实现方式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><div class="note primary simple"><p>gp 3-1 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg" alt="box-x" align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width=52% alt="box-x" align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width=52% alt="box-x" align=left /></div></div></div></div>

<div class="note primary simple"><p>gp 3-2 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg" width = 40% alt="box-x" align=center /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width = 40% alt="box-x" align=right /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width = 40% alt="box-x" align=left /></div></div></div></div>

<div class="note primary simple"><p>gp 3-3 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width = 40% alt="box-x" align=right /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width = 40% alt="box-x" align=left /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg" width = 40% alt="box-x" align=center /></div></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><div class="note primary simple"><p>gp 3-1 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 3-1 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg&quot;</span> <span class="attr">width</span>=<span class="string">52%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg&quot;</span> <span class="attr">width</span>=<span class="string">52%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">left</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p>
<p><div class="note primary simple"><p>gp 3-2 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 3-2 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">right</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">left</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p>
<p><div class="note primary simple"><p>gp 3-3 </p>
</div><br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 3-3 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">right</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">left</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/gEy5Zc1Ai6VuO4N.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">alt</span>=<span class="string">&quot;box-x&quot;</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
<div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">四图效果</button></li><li class="tab"><button type="button" data-href="#test4-2">实现代码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><div class="note primary simple"><p>gp 4-1 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg" width = 40% align=center /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width = 40% align=right /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width = 40% align=left /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg" width = 40% align=center/></div></div></div></div>
<div class="note primary simple"><p>gp 4-2 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg" width = 60%align=center /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width = 72% align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width = 72% align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg" align=center /></div></div></div></div>
<div class="note primary simple"><p>gp 4-3 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg" width = 40% align=left /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg" width = 40% align=right /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg" width = 70% align=left /></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg" align=center /></div></div></div></div>
<div class="note primary simple"><p>gp 4-4 </p>
</div>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg"  width = 72% align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg"  width = 72% align=center /></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg" align=center /></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg"  width = 50% align=center /></div></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><div class="note primary simple"><p>gp 4-1 </p>
</div>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% gp 4-1 %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/E7Jvr4eIPwUNmzq.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/d6QHbytlSYO4FBG.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">align</span>=<span class="string">right</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/6nepIJ1xTgufatZ.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">align</span>=<span class="string">left</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://i.loli.net/2019/12/25/mh19anwBSWIkGlH.jpg&quot;</span> <span class="attr">width</span> = <span class="string">40%</span> <span class="attr">align</span>=<span class="string">center</span> /&gt;</span></span><br><span class="line">&#123;% endgp %&#125;</span><br></pre></td></tr></table></figure>
<div class="note primary simple"><p>其他格式的代码你一定会自己写啦 </p>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
]]></content>
      <categories>
        <category>工科生的基本功</category>
        <category>Github</category>
      </categories>
      <tags>
        <tag>Library</tag>
        <tag>Github</tag>
      </tags>
  </entry>
  <entry>
    <title>Mujoco210安装</title>
    <url>/archives/9765ce9e.html</url>
    <content><![CDATA[<p>本文将介绍Mujoco210的安装过程。<br><span id="more"></span></p>
<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h1><p>重装电脑后，需要重配置Mujoco环境，遂升级至210版本。安装平台：Ubuntu18.04 + Mujoco 2.1.0 + mujoco_py</p>
<h1 id="2-Mujoco的安装"><a href="#2-Mujoco的安装" class="headerlink" title="2 Mujoco的安装"></a>2 Mujoco的安装</h1><ol>
<li>下载 Mujoco210 Linux 版本： <a href="https://mujoco.org/download/mujoco210-linux-x86_64.tar.gz">https://mujoco.org/download/mujoco210-linux-x86_64.tar.gz</a>.</li>
<li>执行下列指令。<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> ~/.mujoco                                    <span class="comment"># 创建文件夹</span></span><br><span class="line"><span class="built_in">cd</span> mujoco210下载路径</span><br><span class="line">tar -zxvf mujoco210-linux-x86_64.tar.gz -C ~/.mujoco <span class="comment"># 解压至~/.mujoco</span></span><br><span class="line">sudo gedit ~/.basrc</span><br><span class="line"><span class="comment"># 最后添加 export LD_LIBRARY_PATH=~/.mujoco/mujoco210/bin</span></span><br><span class="line"><span class="comment"># 保存退出</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li>
<li>执行下列指令验证是否安装成功。<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.mujoco/mujoco210/bin</span><br><span class="line">./simulate ../model/humanoid.xml</span><br></pre></td></tr></table></figure></li>
<li>顺利的话，会出现下图所示的结果。<br><img src="/images/20220726/01.png" alt="1"></li>
</ol>
<h1 id="3-mujoco-py的安装"><a href="#3-mujoco-py的安装" class="headerlink" title="3 mujoco_py的安装"></a>3 mujoco_py的安装</h1><h2 id="3-1-mujoco-py的下载"><a href="#3-1-mujoco-py的下载" class="headerlink" title="3.1 mujoco_py的下载"></a>3.1 mujoco_py的下载</h2><p>执行下列语句下载 mujoco_py。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/openai/mujoco-py.git</span><br></pre></td></tr></table></figure></p>
<h2 id="3-2-mujoco-py的安装"><a href="#3-2-mujoco-py的安装" class="headerlink" title="3.2 mujoco_py的安装"></a>3.2 mujoco_py的安装</h2><p>依赖项的安装。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 注意可能需要科学上网</span></span><br><span class="line">sudo apt-get install libgl1-mesa-dev libgl1-mesa-glx libosmesa6-dev</span><br><span class="line">sudo apt-get install libglew-dev</span><br><span class="line">sudo apt-get install patchelf</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>如果不安装这个依赖项，可能会出现第4节中的问题。</p>
</blockquote>
<p>mujoco_py的安装。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda activate py38  <span class="comment"># 激活自己用anaconda配置的环境</span></span><br><span class="line"><span class="built_in">cd</span> ~/mujoco-py       <span class="comment"># 自己下载mujoco-py的路径</span></span><br><span class="line"></span><br><span class="line">pip3 install -U <span class="string">&#x27;mujoco-py&lt;2.2,&gt;=2.1&#x27;</span></span><br><span class="line">pip3 install -r requirements.txt</span><br><span class="line">pip3 install -r requirements.dev.txt</span><br><span class="line">python3 setup.py install</span><br></pre></td></tr></table></figure></p>
<h2 id="3-3-配置-bashrc"><a href="#3-3-配置-bashrc" class="headerlink" title="3.3 配置.bashrc"></a>3.3 配置.bashrc</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo gedit ~/.bashrc</span><br><span class="line"><span class="comment"># 文件最后添加 export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/nvidia </span></span><br><span class="line"><span class="comment"># 再添加 export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libGLEW.so</span></span><br><span class="line"><span class="comment"># 保存退出</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>
<h2 id="3-4-验证安装成功"><a href="#3-4-验证安装成功" class="headerlink" title="3.4 验证安装成功"></a>3.4 验证安装成功</h2><p>新开一个终端，如下图所示。<br><img src="/images/20220726/05.png" alt="5"></p>
<p>运行 mujoco_py 中自带的例子：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/mujoco-py/examples/            <span class="comment"># 打开 mujoco_py 的 examples 路径</span></span><br><span class="line">python3 setting_state.py </span><br></pre></td></tr></table></figure></p>
<p>成功的话将会出现下面的结果。</p>
<video id="video" controls="" preload="none">
    <source id="mp4" src="/images/20210305/mujoco_example.mp4" type="video/mp4">
</video>

<h1 id="4-出现的问题"><a href="#4-出现的问题" class="headerlink" title="4 出现的问题"></a>4 出现的问题</h1><p>在终端中执行 <code>import mujoco_py</code> 时出现如下问题：</p>
<ol>
<li>fata error: X11/Xlib.h: No such file or directory<br><img src="/images/20220726/02.png" alt="2"></li>
<li>fatal error: GL/glew.h: No such file or directory<br><img src="/images/20220726/03.png" alt="3"></li>
<li>No such file or directory: ‘patchelf’<br><img src="/images/20220726/04.png" alt="4"></li>
</ol>
<p>解决办法： 安装第3.2节的依赖。</p>
<p>终端能正常运行后，运行示例程序时直接卡死，终端提示 ERROR: GLEW initalization error: Missing GL version。<br><img src="/images/20220726/06.png" alt="6"></p>
<p>解决办法： 在 <code>~/.bashrc</code> 中添加 export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libGLEW.so</p>
<h1 id="5-Pycharm-中运行mujoco-py会出现的问题"><a href="#5-Pycharm-中运行mujoco-py会出现的问题" class="headerlink" title="5 Pycharm 中运行mujoco_py会出现的问题"></a>5 Pycharm 中运行mujoco_py会出现的问题</h1><p>在Pycharm中运行mujoco_py会出现环境变量的问题，解决方法是手动添加环境变量。<br>Pycharm -&gt; <code>Run</code> -&gt; <code>Edit Configurations</code> -&gt; <code>Environment Variables</code>，添加：<br>$LD_LIBRARY_PATH:/home/robot/.mujoco/mujoco210/bin:$LD_LIBRARY_PATH:/usr/lib/nvidia</p>
<blockquote>
<p>注意两个环境变量中间用一个:隔开<br><img src="/images/20220726/07.png" alt="7"></p>
</blockquote>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/486957504">https://zhuanlan.zhihu.com/p/486957504</a></li>
<li><a href="https://www.cnblogs.com/devilmaycry812839668/p/16007042.html">https://www.cnblogs.com/devilmaycry812839668/p/16007042.html</a></li>
<li><a href="https://blog.csdn.net/weixin_44420419/article/details/116231500">https://blog.csdn.net/weixin_44420419/article/details/116231500</a></li>
<li><a href="https://github.com/openai/mujoco-py/issues/652">https://github.com/openai/mujoco-py/issues/652</a></li>
<li><a href="https://github.com/openai/mujoco-py">https://github.com/openai/mujoco-py</a></li>
<li><a href="https://codeantenna.com/a/78cxVW5Ate">https://codeantenna.com/a/78cxVW5Ate</a></li>
</ol>
]]></content>
      <categories>
        <category>人工智能</category>
        <category>强化学习</category>
      </categories>
      <tags>
        <tag>Library</tag>
      </tags>
  </entry>
  <entry>
    <title>用seaborn/matplot绘制误差带阴影图</title>
    <url>/archives/7cd1c910.html</url>
    <content><![CDATA[<p>记录利用 seaborn、matplot 绘制带有误差带阴影的图。<br><span id="more"></span></p>
<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h1><p>因为在强化学习中经常要用到利用误差带绘的阴影图，因此特地记录一下。实现的时候有两种方法，一种是 seaborn，另一种是matplot。接下来将分别介绍。<br><!-- 中进行回归分析的时候可以生成一些自带误差带的图，参考[链接5]((https://seaborn.pydata.org/examples/errorband_lineplots.html))，可似乎并没有提到应该怎么制定误差带阴影，如果要自定义的话，还是需要用matplot中的 [fill_between(x, y1, y2)](https://matplotlib.org/stab